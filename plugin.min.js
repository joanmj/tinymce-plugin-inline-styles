!function(a){a.PluginManager.add("inlinestyles",function(a){function b(a){var b={};for(var c in a){var d=a[c].split(":");""!==d[0].trim()&&""!==d[1].trim()&&(b[d[0].trim()]=d[1].trim())}return b}function c(a){if(a[0]&&a[0].styleSheets&&a[0].styleSheets.length){var c=a[0].styleSheets[0];if(c.cssRules)for(var d in c.cssRules)try{var e=c.cssRules[d];if(!isNaN(e))break;var f=a.find(e.selectorText),g=e.cssText.replace(e.selectorText,"");g=g.replace("{","").replace("}","");var h=g.split(";");f.css(b(h))}catch(i){console.error(i)}}}function d(a,b,c){a.indexOf(b)>-1&&c.push(new RegExp(b,"i"))}function e(a){var b=window.open("","tmpHtml","width=0,height=0");window.blur();var e=b.document,g=jQuery(e);e.write(a),c(g),g.find("style").remove();var h=g.find("html").html();b.close();var i=[];return d(h,'href="',i),d(h,'src="',i),f(h,i)}function f(a,b){for(var c=a,d=0;d<b.length;d++)c=g(c,b[d]);return c}function g(a,b){for(var c,d,e="",f=0;f<a.length;f++)if(c=a.substring(f),d=c.search(b),0!==d){if(!(d>0)){e+=a.substring(f);break}e+=a.substring(f,d),f=d-1}else!function(){var d=c.indexOf('"'),g=c.indexOf('"',d+1),h=a.substring(f+d+1,f+g+1);h=h.replace(/&amp;/g,"&");var i="/".length,j="/i".length;e+=String(b).substring(i,String(b).length-j)+h,f+=g}();return e}function h(a){console.info("inlinifing");var b;try{b=e(a.content)}catch(c){console.error("Inlining css stylesheets failed"),console.error(c)}b&&(a.content="<!DOCTYPE html><html>"+b+"</html>")}var i,j=!1,k=!1;a.on("GetContent",function(a){j=a.source_view||!1}),a.on("BeforeSetContent",function(a){j?(i=a.content,j=!1,h(a)):!k&&a.content&&a.content.length&&(h(a),k=!0)})})}(tinymce);